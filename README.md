# SG-Transformer
# A multi-step water quality prediction model based on the Savitzky-Golay filter and Transformer optimized network.
Effective water quality prediction techniques are essential for the sustainable development of water resources and implementation of emergency response mechanisms. However, the water environment conditions are complex, and the presence of a large amount of noise in the water quality data makes it difficult to reveal the long-term trends or cycles of the data, affecting the acquisition of serial correlation in the data. In addition, the loss function based on the vertical Euclidean distance will produce a prediction lag problem, it is difficult to make an accurate multi-step prediction of water quality series. This paper presents a multi-step water quality prediction model for watersheds that combines Savitzky-Golay (SG) filter with Transformer optimized networks. Among them, the SG filter highlights data trend change and improves sequence correlation by smoothing the potential noise of original data. The transformer network adopts a sequence-to-sequence framework, which contains a position encoding module and a self-attentive mechanism to perform multi-step prediction while effectively obtaining the sequence correlation. Moreover, the DIstortion Loss including shApe and TimE (DILATE) loss function is introduced into the model to solve the problem of prediction lag from two aspects of shape error and time error to improve the model's generalization ability. An example validates the model with the benchmark model at four monitoring stations in the Lanzhou section of the Yellow River basin in China. The results show that the predictions of the proposed model have the correct shape, temporal positioning, and the best accuracy in a multi-step prediction task for four sites. It can provide a decision-making basis for comprehensive water quality control and pollutant control in the basin.
